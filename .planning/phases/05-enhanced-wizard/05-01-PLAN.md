---
phase: 05-enhanced-wizard
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - webapp/channels/src/packages/mattermost-redux/src/actions/recaps.ts
  - webapp/channels/src/packages/mattermost-redux/src/action_types/recaps.ts
autonomous: true

must_haves:
  truths:
    - "Frontend can dispatch createScheduledRecap action"
    - "Frontend can dispatch updateScheduledRecap action"
    - "Redux store updates with created/updated scheduled recap"
  artifacts:
    - path: "webapp/channels/src/packages/mattermost-redux/src/actions/recaps.ts"
      provides: "createScheduledRecap and updateScheduledRecap async actions"
      exports: ["createScheduledRecap", "updateScheduledRecap"]
    - path: "webapp/channels/src/packages/mattermost-redux/src/action_types/recaps.ts"
      provides: "Action types for create/update scheduled recaps"
      contains: "CREATE_SCHEDULED_RECAP"
  key_links:
    - from: "actions/recaps.ts"
      to: "Client4.createScheduledRecap"
      via: "async action thunk"
      pattern: "Client4\\.createScheduledRecap"
    - from: "actions/recaps.ts"
      to: "Client4.updateScheduledRecap"
      via: "async action thunk"
      pattern: "Client4\\.updateScheduledRecap"
---

<objective>
Add Redux actions for creating and updating scheduled recaps

Purpose: The modal needs to dispatch create/update actions when user submits the wizard. Client4 methods exist (created in Phase 4) but redux actions are missing.

Output: Two new async redux actions that call Client4 and update the store
</objective>

<execution_context>
@~/.config/opencode/get-shit-done/workflows/execute-plan.md
@~/.config/opencode/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/05-enhanced-wizard/05-RESEARCH.md

Reference files:
@webapp/channels/src/packages/mattermost-redux/src/actions/recaps.ts
@webapp/channels/src/packages/mattermost-redux/src/action_types/recaps.ts
@webapp/platform/client/src/client4.ts (lines 3352-3378 for API methods)
@webapp/platform/types/src/recaps.ts (ScheduledRecapInput type)
</context>

<tasks>

<task type="auto">
  <name>Task 1: Add action type constants for create/update scheduled recap</name>
  <files>webapp/channels/src/packages/mattermost-redux/src/action_types/recaps.ts</files>
  <action>
Add 6 new action type constants following the existing pattern:

```typescript
export const CREATE_SCHEDULED_RECAP_REQUEST = 'CREATE_SCHEDULED_RECAP_REQUEST';
export const CREATE_SCHEDULED_RECAP_SUCCESS = 'CREATE_SCHEDULED_RECAP_SUCCESS';
export const CREATE_SCHEDULED_RECAP_FAILURE = 'CREATE_SCHEDULED_RECAP_FAILURE';
export const UPDATE_SCHEDULED_RECAP_REQUEST = 'UPDATE_SCHEDULED_RECAP_REQUEST';
export const UPDATE_SCHEDULED_RECAP_SUCCESS = 'UPDATE_SCHEDULED_RECAP_SUCCESS';
export const UPDATE_SCHEDULED_RECAP_FAILURE = 'UPDATE_SCHEDULED_RECAP_FAILURE';
```

Add these after the existing scheduled recap action types (near DELETE_SCHEDULED_RECAP_*).
  </action>
  <verify>grep -q "CREATE_SCHEDULED_RECAP_REQUEST" webapp/channels/src/packages/mattermost-redux/src/action_types/recaps.ts</verify>
  <done>6 new action type constants exist for create/update scheduled recap operations</done>
</task>

<task type="auto">
  <name>Task 2: Add createScheduledRecap async action</name>
  <files>webapp/channels/src/packages/mattermost-redux/src/actions/recaps.ts</files>
  <action>
Add createScheduledRecap action following the existing pauseScheduledRecap pattern:

```typescript
import type {ScheduledRecapInput} from '@mattermost/types/recaps';

export function createScheduledRecap(input: ScheduledRecapInput): ActionFuncAsync<ScheduledRecap> {
    return async (dispatch, getState) => {
        dispatch({type: RecapTypes.CREATE_SCHEDULED_RECAP_REQUEST});

        let data: ScheduledRecap;
        try {
            data = await Client4.createScheduledRecap(input);
        } catch (error) {
            forceLogoutIfNecessary(error, dispatch, getState);
            dispatch({type: RecapTypes.CREATE_SCHEDULED_RECAP_FAILURE, error});
            dispatch(logError(error));
            return {error};
        }

        dispatch({type: RecapTypes.RECEIVED_SCHEDULED_RECAP, data});
        dispatch({type: RecapTypes.CREATE_SCHEDULED_RECAP_SUCCESS});

        return {data};
    };
}
```

Ensure ScheduledRecapInput is imported at the top with the existing ScheduledRecap import.
  </action>
  <verify>grep -q "createScheduledRecap" webapp/channels/src/packages/mattermost-redux/src/actions/recaps.ts</verify>
  <done>createScheduledRecap action exists, takes ScheduledRecapInput, returns ScheduledRecap, dispatches RECEIVED_SCHEDULED_RECAP on success</done>
</task>

<task type="auto">
  <name>Task 3: Add updateScheduledRecap async action</name>
  <files>webapp/channels/src/packages/mattermost-redux/src/actions/recaps.ts</files>
  <action>
Add updateScheduledRecap action following the same pattern:

```typescript
export function updateScheduledRecap(id: string, input: ScheduledRecapInput): ActionFuncAsync<ScheduledRecap> {
    return async (dispatch, getState) => {
        dispatch({type: RecapTypes.UPDATE_SCHEDULED_RECAP_REQUEST});

        let data: ScheduledRecap;
        try {
            data = await Client4.updateScheduledRecap(id, input);
        } catch (error) {
            forceLogoutIfNecessary(error, dispatch, getState);
            dispatch({type: RecapTypes.UPDATE_SCHEDULED_RECAP_FAILURE, error});
            dispatch(logError(error));
            return {error};
        }

        dispatch({type: RecapTypes.RECEIVED_SCHEDULED_RECAP, data});
        dispatch({type: RecapTypes.UPDATE_SCHEDULED_RECAP_SUCCESS});

        return {data};
    };
}
```

Note: This takes both `id` and `input` parameters since update requires the existing recap ID.
  </action>
  <verify>grep -q "updateScheduledRecap" webapp/channels/src/packages/mattermost-redux/src/actions/recaps.ts</verify>
  <done>updateScheduledRecap action exists, takes id and input, dispatches RECEIVED_SCHEDULED_RECAP on success</done>
</task>

</tasks>

<verification>
All tasks complete when:
1. Action types file exports 6 new constants (CREATE/UPDATE_SCHEDULED_RECAP_REQUEST/SUCCESS/FAILURE)
2. Actions file exports createScheduledRecap(input: ScheduledRecapInput)
3. Actions file exports updateScheduledRecap(id: string, input: ScheduledRecapInput)
4. Both actions dispatch RECEIVED_SCHEDULED_RECAP on success (store updates automatically via existing reducer)
</verification>

<success_criteria>
- grep confirms CREATE_SCHEDULED_RECAP_REQUEST exists in action_types
- grep confirms createScheduledRecap and updateScheduledRecap exist in actions
- Pattern follows existing pauseScheduledRecap/resumeScheduledRecap exactly
</success_criteria>

<output>
After completion, create `.planning/phases/05-enhanced-wizard/05-01-SUMMARY.md`
</output>
