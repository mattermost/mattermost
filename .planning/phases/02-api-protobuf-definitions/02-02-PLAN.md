---
phase: 02-api-protobuf-definitions
plan: 02
type: execute
depends_on: ["02-01"]
files_modified:
  - server/public/pluginapi/grpc/proto/api_channel_post.proto
  - server/public/pluginapi/grpc/proto/plugin.proto
---

<objective>
Define protobuf request/response messages for all Channel + Post Plugin API methods (including ChannelSidebar + Emoji), replacing the placeholders created in `02-01`.

Purpose: Enable Python plugins to interact with channels and posts via gRPC with parity to the Go Plugin API.
Output: Fully-specified messages in `api_channel_post.proto` (+ any required shared types in `plugin.proto`).
</objective>

<execution_context>
~/.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/phases/01-protocol-foundation/01-RESEARCH.md

# Source of truth: signatures and intended semantics
@server/public/plugin/api.go

# Proto skeleton + generation tooling
@server/public/pluginapi/grpc/proto/api.proto
@server/public/pluginapi/grpc/proto/api_channel_post.proto
@server/public/pluginapi/grpc/proto/bootstrap.proto
@server/public/Makefile

# Model sources of truth for this plan
@server/public/model/channel.go
@server/public/model/channel_member.go
@server/public/model/post.go
@server/public/model/reaction.go
@server/public/model/emoji.go
</context>

<tasks>

<task type="auto">
  <name>Task 1: Implement Channel + ChannelSidebar + Emoji method messages</name>
  <files>server/public/pluginapi/grpc/proto/api_channel_post.proto, server/public/pluginapi/grpc/proto/plugin.proto</files>
  <action>
In `api_channel_post.proto`, replace placeholders for methods assigned to this file (per `02-01` grouping) covering:
- Channel operations (create/update/delete/get, membership, stats, direct/group channels, etc.)
- Channel sidebar categories (create/update/delete/reorder/list)
- Emoji operations (get/list/image, etc.)

Maintain Phase 2 conventions:
- Every `XResponse` has `AppError error = 1;` and success fields start at 2
- Use snake_case field names
- Prefer shared `plugin.proto` messages for `model.Channel`, `model.ChannelMember`, `model.ChannelStats`, `model.OrderedSidebarCategories`, `model.SidebarCategoryWithChannels`, `model.Emoji`, etc.

If a supporting type is missing from `plugin.proto`, add it there (donâ€™t invent duplicate per-plan messages).
  </action>
  <verify>make -C server/public proto-gen succeeds AND no TODO placeholders remain for Channel/ChannelSidebar/Emoji methods in `api_channel_post.proto`</verify>
  <done>All Channel/ChannelSidebar/Emoji method request/response messages are fully defined and codegen passes.</done>
</task>

<task type="auto">
  <name>Task 2: Implement Post + Reaction + Post search/sync method messages</name>
  <files>server/public/pluginapi/grpc/proto/api_channel_post.proto, server/public/pluginapi/grpc/proto/plugin.proto</files>
  <action>
Complete the remaining placeholders in `api_channel_post.proto` for Post-related methods, including (at minimum):
- CRUD: create/update/delete/get posts
- Reactions
- Ephemeral posts
- Post listing/search/sync-related methods (`PostList`, `PostSearchResults`, sync cursor types, etc.)

Keep responses consistent (`AppError error = 1`) and ensure all referenced `model.*` types used by these RPCs exist in `plugin.proto` (e.g., `Post`, `PostList`, `PostSearchResults`, `Reaction`, any search parameter structs).
  </action>
  <verify>go run ./server/public/pluginapi/grpc/cmd/apiverify reports parity AND make -C server/public proto-gen succeeds AND no TODO placeholders remain in `api_channel_post.proto`</verify>
  <done>`api_channel_post.proto` contains no placeholders; all Channel/Post RPCs compile and the service remains in sync with the Go interface.</done>
</task>

</tasks>

<verification>
Before declaring this plan complete:
- [ ] `go run ./server/public/pluginapi/grpc/cmd/apiverify` reports no missing/extra RPCs
- [ ] `make -C server/public proto-gen` succeeds
- [ ] No placeholder TODOs remain in `server/public/pluginapi/grpc/proto/api_channel_post.proto`
</verification>

<success_criteria>

- Channel/Post protobuf messages are fully defined (no placeholders)
- Shared types required for these methods exist in `plugin.proto`
- Go proto generation succeeds
  </success_criteria>

<output>
After completion, create `.planning/phases/02-api-protobuf-definitions/02-02-SUMMARY.md`:

# Phase 2 Plan 02: Channel and Post API Protos Summary

**Filled in Channel/Post protobuf messages for PluginAPI with parity-safe error payloads.**

## Accomplishments

## Files Created/Modified

## Decisions Made

## Issues Encountered

## Next Step

Ready for `02-03-PLAN.md` and `02-04-PLAN.md` (can execute in parallel after `02-01`)
</output>


